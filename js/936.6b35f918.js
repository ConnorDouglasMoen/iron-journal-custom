"use strict";(globalThis["webpackChunkiron_journal"]=globalThis["webpackChunkiron_journal"]||[]).push([[936],{1936:(e,a,l)=>{l.r(a),l.d(a,{default:()=>ha});var o=l(1758),t=l(8790);const n={class:"row items-center q-mb-md q-gutter-sm"},s={class:"col-shrink"},d={class:"row justify-center q-mb-md"},m={key:0},c={class:"row q-gutter-sm"},i={key:1},u={class:"row q-mb-sm"},p={class:"row q-gutter-sm"},r={class:"column q-mt-md"},g={key:0},b=(0,o.Lk)("div",{class:"q-pt-xs"},null,-1),h={key:0},f={key:1},V={key:2},v=(0,o.Lk)("div",{class:"col-grow"},"Map Config",-1),k=(0,o.eW)(" Warning: Changing hex radius/width/height values will change the positioning of any locations you currently have saved. You should aim to have your hexes configured before you start adding locations. "),w={class:"col"},x={class:"col"},y=(0,o.eW)("Add Map");function C(e,a,l,C,F,q){const U=(0,o.g2)("q-btn"),L=(0,o.g2)("q-select"),I=(0,o.g2)("hex-map"),D=(0,o.g2)("i-input"),E=(0,o.g2)("w-location"),z=(0,o.g2)("w-site"),M=(0,o.g2)("w-npc"),A=(0,o.g2)("q-card-section"),S=(0,o.g2)("q-expansion-item"),W=(0,o.g2)("q-input"),Q=(0,o.g2)("q-toggle"),X=(0,o.g2)("q-card-actions"),R=(0,o.g2)("q-card"),j=(0,o.g2)("q-dialog"),O=(0,o.g2)("q-file"),K=(0,o.g2)("q-page");return(0,o.uX)(),(0,o.Wv)(K,{padding:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",n,[(0,o.bF)(U,{class:"col-shrink",flat:"",dense:"",icon:"add_circle",onClick:a[0]||(a[0]=a=>{e.mapLoad=e.NewMapLoad(),e.mapLoad.show=!0})}),(0,o.bF)(L,{class:"col",label:"Map",modelValue:e.config.data.map,"onUpdate:modelValue":a[1]||(a[1]=a=>e.config.data.map=a),options:e.mapOpts,"emit-value":"","map-options":"",standout:"bg-blue-grey text-white","input-style":{color:"#ECEFF4"},dense:""},null,8,["modelValue","options"]),e.config.data.edit&&e.campaign.data.maps.length>1?((0,o.uX)(),(0,o.Wv)(U,{key:0,class:"col-shrink",flat:"",dense:"",icon:"delete",onClick:e.removeMap},null,8,["onClick"])):(0,o.Q3)("",!0),(0,o.Lk)("div",s,[(0,o.bF)(U,{icon:"mdi-magnify-minus",flat:"",dense:"",onClick:a[2]||(a[2]=a=>{e.campaign.data.maps[e.config.data.map].zoom>1&&(e.campaign.data.maps[e.config.data.map].zoom-=.5)})}),(0,o.eW)(" "+(0,t.v_)(e.campaign.data.maps[e.config.data.map].zoom)+" ",1),(0,o.bF)(U,{icon:"mdi-magnify-plus",flat:"",dense:"",onClick:a[3]||(a[3]=a=>e.campaign.data.maps[e.config.data.map].zoom+=.5)})])]),(0,o.Lk)("div",d,[(0,o.bF)(I,{searchResults:e.results},null,8,["searchResults"])]),e.$q.screen.gt.xs?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",c,[(0,o.bF)(D,{class:"col",label:"Map Name",modelValue:e.campaign.data.maps[e.config.data.map].name,"onUpdate:modelValue":a[4]||(a[4]=a=>e.campaign.data.maps[e.config.data.map].name=a)},null,8,["modelValue"]),(0,o.bF)(D,{class:"col",label:"Search",modelValue:e.searchText,"onUpdate:modelValue":a[5]||(a[5]=a=>e.searchText=a),clearable:""},null,8,["modelValue"]),(0,o.bF)(L,{class:"col",label:"Filters",modelValue:e.filters,"onUpdate:modelValue":a[6]||(a[6]=a=>e.filters=a),options:Object.values(e.EMapItems),multiple:"",clearable:"",standout:"bg-blue-grey text-white","input-style":{color:"#ECEFF4"},dense:""},null,8,["modelValue","options"]),(0,o.bF)(U,{class:"col-shrink",flat:"",dense:"",icon:"mdi-cog",onClick:e.openMapConfig},null,8,["onClick"])])])):((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",u,[(0,o.bF)(D,{class:"col",label:"Map Name",modelValue:e.campaign.data.maps[e.config.data.map].name,"onUpdate:modelValue":a[7]||(a[7]=a=>e.campaign.data.maps[e.config.data.map].name=a)},null,8,["modelValue"])]),(0,o.Lk)("div",p,[(0,o.bF)(D,{class:"col",label:"Search",modelValue:e.searchText,"onUpdate:modelValue":a[8]||(a[8]=a=>e.searchText=a),clearable:""},null,8,["modelValue"]),(0,o.bF)(L,{class:"col",label:"Filters",modelValue:e.filters,"onUpdate:modelValue":a[9]||(a[9]=a=>e.filters=a),options:Object.values(e.EMapItems),multiple:"",clearable:"",standout:"bg-blue-grey text-white","input-style":{color:"#ECEFF4"},dense:""},null,8,["modelValue","options"]),(0,o.bF)(U,{class:"col-shrink",flat:"",dense:"",icon:"mdi-cog",onClick:e.openMapConfig},null,8,["onClick"])])])),(0,o.Lk)("div",r,[e.results!={}?((0,o.uX)(),(0,o.CE)("div",g,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.results,((a,l)=>((0,o.uX)(),(0,o.Wv)(S,{class:"q-mb-lg",key:l,"default-opened":"","header-class":"text-h4",label:e.campaign.data.maps[+l].name},{default:(0,o.k6)((()=>[(0,o.bF)(D,{class:"q-mb-sm",label:"Map Notes",modelValue:e.campaign.data.maps[+l].notes,"onUpdate:modelValue":a=>e.campaign.data.maps[+l].notes=a,autogrow:""},null,8,["modelValue","onUpdate:modelValue"]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a,((a,t)=>((0,o.uX)(),(0,o.Wv)(S,{class:"q-mb-md rounded-borders q-pa-none col-grow","header-class":"text-h6 card-bg",flat:"","default-opened":"",key:t,label:e.CellLabel(e.campaign.data.maps[+l].cells[t],t).label},{default:(0,o.k6)((()=>[b,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a,((a,n)=>((0,o.uX)(),(0,o.Wv)(A,{class:"q-px-xs q-py-none",key:n},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a,(a=>((0,o.uX)(),(0,o.CE)("div",{key:a},[n===e.EMapItems.Locations?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(E,{modelValue:e.campaign.data.maps[+l].cells[t][n][+a],"onUpdate:modelValue":o=>e.campaign.data.maps[+l].cells[t][n][+a]=o,onDelete:o=>e.campaign.removeObject(n,+l,t,a)},null,8,["modelValue","onUpdate:modelValue","onDelete"])])):(0,o.Q3)("",!0),n===e.EMapItems.Sites?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.bF)(z,{modelValue:e.campaign.data.maps[+l].cells[t][n][+a],"onUpdate:modelValue":o=>e.campaign.data.maps[+l].cells[t][n][+a]=o,onDelete:o=>e.campaign.removeObject(n,+l,t,a)},null,8,["modelValue","onUpdate:modelValue","onDelete"])])):(0,o.Q3)("",!0),n===e.EMapItems.NPCs?((0,o.uX)(),(0,o.CE)("div",V,[(0,o.bF)(M,{modelValue:e.campaign.data.maps[+l].cells[t][n][+a],"onUpdate:modelValue":o=>e.campaign.data.maps[+l].cells[t][n][+a]=o,onDelete:o=>e.campaign.removeObject(n,+l,t,a)},null,8,["modelValue","onUpdate:modelValue","onDelete"])])):(0,o.Q3)("",!0)])))),128))])),_:2},1024)))),128))])),_:2},1032,["label"])))),128))])),_:2},1032,["label"])))),128))])):(0,o.Q3)("",!0)]),(0,o.bF)(j,{modelValue:e.showMapConfig,"onUpdate:modelValue":a[19]||(a[19]=a=>e.showMapConfig=a)},{default:(0,o.k6)((()=>[(0,o.bF)(R,null,{default:(0,o.k6)((()=>[(0,o.bF)(A,{class:"row card-bg items-center"},{default:(0,o.k6)((()=>[v,(0,o.bF)(U,{class:"col-shrink",icon:"close",flat:"",dense:"",onClick:a[10]||(a[10]=a=>e.showMapConfig=!1)})])),_:1}),(0,o.bF)(A,{class:"text-justify"},{default:(0,o.k6)((()=>[k])),_:1}),(0,o.bF)(A,{class:"row justify-between q-gutter-sm"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",w,[(0,o.bF)(W,{label:"Height (px)",type:"number",modelValue:e.mapConfig.height,"onUpdate:modelValue":a[11]||(a[11]=a=>e.mapConfig.height=a),modelModifiers:{number:!0}},null,8,["modelValue"]),(0,o.bF)(W,{label:"Width (px)",type:"number",modelValue:e.mapConfig.width,"onUpdate:modelValue":a[12]||(a[12]=a=>e.mapConfig.width=a),modelModifiers:{number:!0}},null,8,["modelValue"]),(0,o.bF)(W,{label:"Location Label Size",type:"number",modelValue:e.mapConfig.locLabel,"onUpdate:modelValue":a[13]||(a[13]=a=>e.mapConfig.locLabel=a),modelModifiers:{number:!0}},null,8,["modelValue"]),(0,o.bF)(W,{label:"Search Label Size",type:"number",modelValue:e.mapConfig.srcLabel,"onUpdate:modelValue":a[14]||(a[14]=a=>e.mapConfig.srcLabel=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),(0,o.Lk)("div",x,[(0,o.bF)(W,{label:"Hex Radius (px)",type:"number",modelValue:e.mapConfig.hex,"onUpdate:modelValue":a[15]||(a[15]=a=>e.mapConfig.hex=a),modelModifiers:{number:!0},min:10},null,8,["modelValue"]),(0,o.bF)(W,{label:"Hexes (wide)",type:"number",modelValue:e.mapConfig.hexW,"onUpdate:modelValue":a[16]||(a[16]=a=>e.mapConfig.hexW=a),modelModifiers:{number:!0},min:0},null,8,["modelValue"]),(0,o.bF)(W,{label:"Hexes (high)",type:"number",modelValue:e.mapConfig.hexH,"onUpdate:modelValue":a[17]||(a[17]=a=>e.mapConfig.hexH=a),modelModifiers:{number:!0},min:0},null,8,["modelValue"]),(0,o.bF)(Q,{label:"Flat hexes",modelValue:e.mapConfig.flat,"onUpdate:modelValue":a[18]||(a[18]=a=>e.mapConfig.flat=a)},null,8,["modelValue"])])])),_:1}),(0,o.bF)(X,{align:"right"},{default:(0,o.k6)((()=>[(0,o.bF)(U,{color:"primary",flat:"",label:"Save",onClick:e.saveMapConfig},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(j,{modelValue:e.mapLoad.show,"onUpdate:modelValue":a[25]||(a[25]=a=>e.mapLoad.show=a)},{default:(0,o.k6)((()=>[(0,o.bF)(R,{class:"card-bg"},{default:(0,o.k6)((()=>[(0,o.bF)(A,{class:"text-center text-bold bg-secondary"},{default:(0,o.k6)((()=>[y])),_:1}),(0,o.bF)(A,null,{default:(0,o.k6)((()=>[(0,o.bF)(W,{class:"q-mb-sm",label:"Name",modelValue:e.mapLoad.name,"onUpdate:modelValue":a[20]||(a[20]=a=>e.mapLoad.name=a),dense:""},null,8,["modelValue"]),(0,o.bF)(O,{class:"q-mb-sm",modelValue:e.mapLoad.image,"onUpdate:modelValue":a[21]||(a[21]=a=>e.mapLoad.image=a),dense:"",label:"Select Image",accept:"image/*"},null,8,["modelValue"]),(0,o.bF)(W,{class:"q-mb-sm",label:"Height (px)",type:"number",modelValue:e.mapLoad.height,"onUpdate:modelValue":a[22]||(a[22]=a=>e.mapLoad.height=a),modelModifiers:{number:!0},dense:""},null,8,["modelValue"]),(0,o.bF)(W,{class:"q-mb-sm",label:"Width (px)",type:"number",modelValue:e.mapLoad.width,"onUpdate:modelValue":a[23]||(a[23]=a=>e.mapLoad.width=a),modelModifiers:{number:!0},dense:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(X,{align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(U,{label:"Load",flat:"",color:"primary",onClick:e.loadMap},null,8,["onClick"]),(0,o.bF)(U,{label:"Save",flat:"",color:"primary",onClick:e.saveMap,disable:!e.mapLoad.loaded},null,8,["onClick","disable"]),(0,o.bF)(U,{label:"Close",flat:"",color:"warning",dense:"",onClick:a[24]||(a[24]=a=>e.mapLoad.show=!1)})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var F=l(8734),q=l(9324),U=l(2283),L=l(8511),I=l(9211),D=l(9187),E=l(9104);const z={class:"text-h6 row sf-header items-center q-pa-lg bg-dark"},M=(0,o.eW)(" Rendering Map... "),A={class:"row q-gutter-sm items-center"};function S(e,a,l,n,s,d){const m=(0,o.g2)("q-btn"),c=(0,o.g2)("q-page"),i=(0,o.g2)("q-page-container"),u=(0,o.g2)("q-layout"),p=(0,o.g2)("q-input"),r=(0,o.g2)("q-card-section"),g=(0,o.g2)("q-select"),b=(0,o.g2)("cell"),h=(0,o.g2)("q-card"),f=(0,o.g2)("q-dialog"),V=(0,o.gN)("scroll");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(u,{view:"hHh lpR fFf",container:"",style:(0,t.Tr)({width:`${e.campaign.data.maps[e.config.data.map].width+20}px`,height:"500px"})},{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(c,{ref:"mapbox"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.Lk)("div",z,[M,(0,o.bF)(m,{label:"LOADING",flat:"",loading:""})],512),[[E.aG,e.mapLoading]]),(0,o.bo)((0,o.Lk)("div",{class:"hexmap",ref:"hexmap",id:"hexmap",style:(0,t.Tr)({minWidth:`${e.campaign.data.maps[e.config.data.map].width}px`,height:`${e.campaign.data.maps[e.config.data.map].height}px`}),onClick:a[0]||(a[0]=a=>e.click(a))},null,4),[[E.aG,!e.mapLoading]])])),_:1})),[[V,e.onScroll]])])),_:1})])),_:1},8,["style"]),(0,o.bF)(f,{modelValue:e.showDialog,"onUpdate:modelValue":a[5]||(a[5]=a=>e.showDialog=a),"transition-show":"fade","transition-hide":"fade"},{default:(0,o.k6)((()=>[(0,o.bF)(h,{class:"card-bg",style:{"min-width":"40%"}},{default:(0,o.k6)((()=>[(0,o.bF)(r,{class:"row justify-between items-center bg-secondary text-h5"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{class:"col",label:"Cell Name",modelValue:e.campaign.data.maps[e.config.data.map].cells[e.selectedID].name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.campaign.data.maps[e.config.data.map].cells[e.selectedID].name=a),dense:"",borderless:""},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-shrink",icon:"close",flat:"",dense:"",onClick:a[2]||(a[2]=a=>e.showDialog=!1)})])),_:1}),(0,o.bF)(r,{class:"q-pa-sm q-mb-sm"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",A,[(0,o.bF)(g,{class:"col-grow",label:"Set cell status",hint:"Set to 'location' to save Oracle generated content and enable search for this cell",modelValue:e.campaign.data.maps[e.config.data.map].cells[e.selectedID].stat,"onUpdate:modelValue":a[3]||(a[3]=a=>e.campaign.data.maps[e.config.data.map].cells[e.selectedID].stat=a),options:Object.values(e.ECellStatus)},null,8,["modelValue","options"]),(0,o.bF)(m,{class:"col-shrink",dense:"",outline:"",label:"Go here",onClick:a[4]||(a[4]=a=>e.campaign.data.maps[e.config.data.map].player=e.selectedID)})])])),_:1}),(0,o.bF)(r,{class:"q-pa-sm"},{default:(0,o.k6)((()=>[(0,o.bF)(b,{mapID:e.config.data.map,cellID:e.selectedID},null,8,["mapID","cellID"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var W=l(9374),Q=l(3710),X=l(3310),R=l(9931);const j={[q.cw.NPCs]:"#A37BA8ff",[q.cw.Sites]:"#51959fff",[q.cw.Locations]:"#849accff",route:"rgba(150, 150, 150, 0.6)",location:"rgba(0, 0, 0, 0.6)"};var O=l(3257);const K={class:"row full-width q-gutter-sm justify-between items-center"},_={key:0},N={key:1},$={key:2};function T(e,a,l,t,n,s){const d=(0,o.g2)("q-toggle"),m=(0,o.g2)("q-select"),c=(0,o.g2)("q-btn"),i=(0,o.g2)("w-location"),u=(0,o.g2)("w-npc"),p=(0,o.g2)("w-site");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",K,[(0,o.bF)(d,{class:"col",icon:"mdi-cog",modelValue:e.showControls,"onUpdate:modelValue":a[0]||(a[0]=a=>e.showControls=a),label:"Move Controls"},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-shrink",label:"Add",modelValue:e.addSelect,"onUpdate:modelValue":a[1]||(a[1]=a=>e.addSelect=a),options:Object.values(e.EMapItems),dense:"",borderless:""},null,8,["modelValue","options"]),(0,o.bF)(c,{class:"col-shrink",icon:"add",flat:"",dense:"",onClick:e.add},null,8,["onClick"])]),e.show(e.EMapItems.Locations)?((0,o.uX)(),(0,o.CE)("div",_,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.campaign.data.maps[e.mapID].cells[e.cellID].locations,((a,l)=>((0,o.uX)(),(0,o.Wv)(i,{class:"q-mt-sm",key:l,modelValue:e.campaign.data.maps[e.mapID].cells[e.cellID].locations[l],"onUpdate:modelValue":a=>e.campaign.data.maps[e.mapID].cells[e.cellID].locations[l]=a,onDelete:a=>e.campaign.removeObject(e.EMapItems.Locations,e.mapID,e.cellID,l),controls:e.showControls,onMove:a=>e.campaign.moveLocation(l,{map:e.mapID,cell:e.cellID},a)},null,8,["modelValue","onUpdate:modelValue","onDelete","controls","onMove"])))),128))])):(0,o.Q3)("",!0),e.show(e.EMapItems.NPCs)?((0,o.uX)(),(0,o.CE)("div",N,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.campaign.data.maps[e.mapID].cells[e.cellID].npcs,((a,l)=>((0,o.uX)(),(0,o.Wv)(u,{class:"q-mt-sm",key:l,modelValue:e.campaign.data.maps[e.mapID].cells[e.cellID].npcs[l],"onUpdate:modelValue":a=>e.campaign.data.maps[e.mapID].cells[e.cellID].npcs[l]=a,onDelete:a=>e.campaign.removeObject(e.EMapItems.NPCs,e.mapID,e.cellID,l),controls:e.showControls,onMove:a=>e.campaign.moveNPC(l,{map:e.mapID,cell:e.cellID},a)},null,8,["modelValue","onUpdate:modelValue","onDelete","controls","onMove"])))),128))])):(0,o.Q3)("",!0),e.show(e.EMapItems.Sites)?((0,o.uX)(),(0,o.CE)("div",$,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.campaign.data.maps[e.mapID].cells[e.cellID].sites,((a,l)=>((0,o.uX)(),(0,o.Wv)(p,{class:"q-mt-sm",key:l,modelValue:e.campaign.data.maps[e.mapID].cells[e.cellID].sites[l],"onUpdate:modelValue":a=>e.campaign.data.maps[e.mapID].cells[e.cellID].sites[l]=a,onDelete:a=>e.campaign.removeObject(e.EMapItems.Sites,e.mapID,e.cellID,l),controls:e.showControls,onMove:a=>e.campaign.moveSite(l,{map:e.mapID,cell:e.cellID},a)},null,8,["modelValue","onUpdate:modelValue","onDelete","controls","onMove"])))),128))])):(0,o.Q3)("",!0)])}const B={key:1,class:"row q-gutter-sm q-mb-sm no-wrap"},H={key:2},P={class:"row q-gutter-sm q-mb-sm no-wrap"},G={class:"row q-gutter-sm q-mb-sm"},Z={class:"row q-gutter-sm q-mb-sm"},Y={class:"row q-gutter-sm q-mb-sm"};function J(e,a,l,t,n,s){const d=(0,o.g2)("controls"),m=(0,o.g2)("i-input"),c=(0,o.g2)("q-checkbox"),i=(0,o.g2)("q-btn"),u=(0,o.g2)("progress-track"),p=(0,o.g2)("q-expansion-item");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(p,{icon:`img:${e.icon.person()}`,"header-class":"person-header rounded-borders q-mb-sm",label:`${e.data.name} (${e.data.pronouns})`,caption:"Person"},{default:(0,o.k6)((()=>[e.controls?((0,o.uX)(),(0,o.Wv)(d,{key:0,onMove:a[0]||(a[0]=a=>e.$emit("move",a))})):(0,o.Q3)("",!0),e.$q.screen.gt.xs?((0,o.uX)(),(0,o.CE)("div",B,[(0,o.bF)(m,{class:"col",label:"Name",modelValue:e.data.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.name=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Pronouns",modelValue:e.data.pronouns,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.pronouns=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Kin",modelValue:e.data.kin,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.kin=a)},null,8,["modelValue"]),(0,o.bF)(c,{class:"col-shrink",dense:"",label:"Bond",modelValue:e.data.bond,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.bond=a)},null,8,["modelValue"]),e.config.data.edit?((0,o.uX)(),(0,o.Wv)(i,{key:0,icon:"delete",flat:"",dense:"",onClick:a[5]||(a[5]=a=>e.$emit("delete"))})):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",H,[(0,o.Lk)("div",P,[(0,o.bF)(m,{class:"col",label:"Name",modelValue:e.data.name,"onUpdate:modelValue":a[6]||(a[6]=a=>e.data.name=a)},null,8,["modelValue"]),(0,o.bF)(c,{class:"col-shrink",dense:"",label:"Bond",modelValue:e.data.bond,"onUpdate:modelValue":a[7]||(a[7]=a=>e.data.bond=a)},null,8,["modelValue"]),e.config.data.edit?((0,o.uX)(),(0,o.Wv)(i,{key:0,icon:"delete",flat:"",dense:"",onClick:a[8]||(a[8]=a=>e.$emit("delete"))})):(0,o.Q3)("",!0)]),(0,o.Lk)("div",G,[(0,o.bF)(m,{class:"col",label:"Pronouns",modelValue:e.data.pronouns,"onUpdate:modelValue":a[9]||(a[9]=a=>e.data.pronouns=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Kin",modelValue:e.data.kin,"onUpdate:modelValue":a[10]||(a[10]=a=>e.data.kin=a)},null,8,["modelValue"])])])),(0,o.Lk)("div",Z,[(0,o.bF)(m,{class:"col",label:"Role",modelValue:e.data.role,"onUpdate:modelValue":a[11]||(a[11]=a=>e.data.role=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Descriptor",modelValue:e.data.descriptor,"onUpdate:modelValue":a[12]||(a[12]=a=>e.data.descriptor=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Disposition",modelValue:e.data.disposition,"onUpdate:modelValue":a[13]||(a[13]=a=>e.data.disposition=a)},null,8,["modelValue"])]),(0,o.Lk)("div",Y,[(0,o.bF)(m,{class:"col",label:"Goal",modelValue:e.data.goal,"onUpdate:modelValue":a[14]||(a[14]=a=>e.data.goal=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Activity",modelValue:e.data.activity,"onUpdate:modelValue":a[15]||(a[15]=a=>e.data.activity=a)},null,8,["modelValue"])]),(0,o.bF)(m,{class:"q-mb-sm",label:"Notes",modelValue:e.data.notes,"onUpdate:modelValue":a[16]||(a[16]=a=>e.data.notes=a),autogrow:""},null,8,["modelValue"]),(0,o.bF)(u,{class:"q-mb-sm",modelValue:e.data.track,"onUpdate:modelValue":a[17]||(a[17]=a=>e.data.track=a)},null,8,["modelValue"])])),_:1},8,["icon","label"])])}var ee=l(688);const ae={class:"row q-gutter-sm items-center"},le=(0,o.Lk)("span",{class:"col-shrink"},"Move to",-1);function oe(e,a,l,t,n,s){const d=(0,o.g2)("location-select");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",ae,[le,(0,o.bF)(d,{class:"col-grow",icon:"mdi-transfer-right",onSelected:a[0]||(a[0]=a=>e.$emit("move",a))})])])}var te=l(3102);const ne=(0,o.pM)({components:{LocationSelect:te.A},name:"Controls",emits:["move"]});var se=l(2807);const de=(0,se.A)(ne,[["render",oe]]),me=de;var ce=l(340);const ie=(0,o.pM)({components:{IInput:ce.A,ProgressTrack:ee.A,Controls:me},name:"SNPC",props:{modelValue:{type:Object,required:!0},controls:{type:Boolean}},emits:["update:modelValue","delete","move"],setup(e,{emit:a}){const l=(0,F.KR)(e.modelValue);(0,o.wB)((()=>e.modelValue),(()=>l.value=e.modelValue),{deep:!0}),(0,o.wB)((()=>l.value),(()=>a("update:modelValue",l.value)),{deep:!0});const t=(0,L.U)();return{data:l,config:t,icon:O.K}}});var ue=l(6586),pe=l(2225),re=l(9001),ge=l(8582),be=l.n(ge);const he=(0,se.A)(ie,[["render",J]]),fe=he;be()(ie,"components",{QExpansionItem:ue.A,QCheckbox:pe.A,QBtn:re.A});const Ve={key:1,class:"row q-gutter-sm q-mb-sm no-wrap"},ve={key:2},ke={class:"row q-gutter-sm q-mb-sm no-wrap"},we={class:"row q-gutter-sm q-mb-sm"},xe={class:"row q-gutter-sm q-mb-sm"};function ye(e,a,l,t,n,s){const d=(0,o.g2)("controls"),m=(0,o.g2)("i-input"),c=(0,o.g2)("q-select"),i=(0,o.g2)("q-btn"),u=(0,o.g2)("q-expansion-item");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(u,{icon:`img:${e.icon.location(e.data.type)}`,"header-class":"place-header sf-header rounded-borders q-mb-sm",label:e.data.name,caption:`Location: ${e.data.type}`},{default:(0,o.k6)((()=>[e.controls?((0,o.uX)(),(0,o.Wv)(d,{key:0,onMove:a[0]||(a[0]=a=>e.$emit("move",a))})):(0,o.Q3)("",!0),e.$q.screen.gt.xs?((0,o.uX)(),(0,o.CE)("div",Ve,[(0,o.bF)(m,{class:"col",label:"Name",modelValue:e.data.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.name=a)},null,8,["modelValue"]),(0,o.bF)(c,{class:"col",label:"Type",modelValue:e.data.type,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.type=a),options:e.locationOpts,standout:"bg-blue-grey text-white","input-style":{color:"#ECEFF4"},dense:""},null,8,["modelValue","options"]),(0,o.bF)(m,{class:"col",label:"Region",modelValue:e.data.region,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.region=a)},null,8,["modelValue"]),e.config.data.edit?((0,o.uX)(),(0,o.Wv)(i,{key:0,icon:"delete",flat:"",dense:"",onClick:a[4]||(a[4]=a=>e.$emit("delete"))})):(0,o.Q3)("",!0)])):((0,o.uX)(),(0,o.CE)("div",ve,[(0,o.Lk)("div",ke,[(0,o.bF)(m,{class:"col",label:"Name",modelValue:e.data.name,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.name=a)},null,8,["modelValue"]),e.config.data.edit?((0,o.uX)(),(0,o.Wv)(i,{key:0,icon:"delete",flat:"",dense:"",onClick:a[6]||(a[6]=a=>e.$emit("delete"))})):(0,o.Q3)("",!0)]),(0,o.Lk)("div",we,[(0,o.bF)(m,{class:"col",label:"Region",modelValue:e.data.region,"onUpdate:modelValue":a[7]||(a[7]=a=>e.data.region=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Type",modelValue:e.data.type,"onUpdate:modelValue":a[8]||(a[8]=a=>e.data.type=a)},null,8,["modelValue"])])])),(0,o.Lk)("div",xe,[(0,o.bF)(m,{class:"col",label:"Descriptor",modelValue:e.data.descriptor,"onUpdate:modelValue":a[9]||(a[9]=a=>e.data.descriptor=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col",label:"Trouble",modelValue:e.data.trouble,"onUpdate:modelValue":a[10]||(a[10]=a=>e.data.trouble=a)},null,8,["modelValue"])]),(0,o.bF)(m,{label:"Notes",modelValue:e.data.notes,"onUpdate:modelValue":a[11]||(a[11]=a=>e.data.notes=a),autogrow:""},null,8,["modelValue"])])),_:1},8,["icon","label","caption"])])}var Ce=l(5708);const Fe=(0,o.pM)({name:"WLocation",components:{IInput:ce.A,Controls:me},props:{modelValue:{type:Object,required:!0},controls:{type:Boolean}},emits:["update:modelValue","delete","move"],setup(e,{emit:a}){const l=(0,F.KR)(e.modelValue);(0,o.wB)((()=>e.modelValue),(()=>l.value=e.modelValue),{deep:!0}),(0,o.wB)((()=>l.value),(()=>a("update:modelValue",l.value)),{deep:!0});const t=(0,L.U)(),n=/(coast|island)/i.test(l.value.region)?(0,D.ZA)(Ce.a.CoastalWatersLocation):(0,D.ZA)(Ce.a.Location);return{data:l,icon:O.K,config:t,locationOpts:n}}});var qe=l(8515);const Ue=(0,se.A)(Fe,[["render",ye]]),Le=Ue;be()(Fe,"components",{QExpansionItem:ue.A,QSelect:qe.A,QBtn:re.A});const Ie={class:"row q-gutter-sm q-mb-sm"},De={class:"row q-gutter-sm q-mb-sm"},Ee={class:"row items-center justify-center q-mb-sm"},ze=(0,o.Lk)("div",{class:"col-12 text-center text-h5"},"Progress",-1),Me=(0,o.Lk)("div",{class:"text-center text-h5"},"Denizens",-1),Ae={class:"row"},Se={class:"row items-center justify-center q-gutter-sm q-pt-md"},We=(0,o.Lk)("div",{class:"col-xs-4 col-sm text-caption"}," When the outcome of a move prompts an encounter with a denizen, you may: ",-1),Qe={class:"col-shrink text-center text-bold"},Xe=(0,o.Lk)("div",{class:"col-xs-4 col-sm text-caption"}," Choose or introduce a denizen based on the situation and what you know of this place. ",-1),Re=(0,o.Lk)("div",{class:"col-shrink text-center text-bold"},"or",-1),je=(0,o.Lk)("div",{class:"col-xs-4 col-sm text-caption"}," Roll on the matrix to generate a random encounter. If the field is blank, add a new denizen. ",-1),Oe=(0,o.Lk)("div",{class:"col-shrink text-center text-bold"},"or",-1),Ke=(0,o.Lk)("div",{class:"col-xs-4 col-sm text-caption"}," Identify a denizen as ‘likely’ to appear, and Ask the Oracle. If the answer is “no,” roll on the matrix. ",-1),_e=(0,o.Lk)("div",{class:"col-shrink text-center text-bold"},"or",-1),Ne=(0,o.Lk)("div",{class:"col-xs-10 col-sm text-caption"}," Pick two denizens, rate one as ‘likely’, and Ask the Oracle to determine which you encounter. ",-1);function $e(e,a,l,t,n,s){const d=(0,o.g2)("controls"),m=(0,o.g2)("i-input"),c=(0,o.g2)("q-btn"),i=(0,o.g2)("progress-track"),u=(0,o.g2)("q-icon"),p=(0,o.g2)("q-expansion-item");return(0,o.uX)(),(0,o.Wv)(p,{icon:`img:${e.icon.dungeon()}`,"header-class":"site-header rounded-borders q-mb-sm",label:e.data.name,caption:"Delve Site"},{default:(0,o.k6)((()=>[e.controls?((0,o.uX)(),(0,o.Wv)(d,{key:0,onMove:a[0]||(a[0]=a=>e.$emit("move",a))})):(0,o.Q3)("",!0),(0,o.Lk)("div",Ie,[(0,o.bF)(m,{class:"col-grow",label:"Name",dense:"",modelValue:e.data.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.data.name=a)},null,8,["modelValue"]),e.config.data.edit&&e.$q.screen.lt.sm?((0,o.uX)(),(0,o.Wv)(c,{key:0,class:"col-shrink",icon:"delete",dense:"",flat:"",onClick:e.removeSite},null,8,["onClick"])):(0,o.Q3)("",!0),(0,o.bF)(m,{class:"col-grow",label:"Objective",dense:"",modelValue:e.data.objective,"onUpdate:modelValue":a[2]||(a[2]=a=>e.data.objective=a)},null,8,["modelValue"]),e.config.data.edit&&e.$q.screen.gt.xs?((0,o.uX)(),(0,o.Wv)(c,{key:1,class:"col-shrink",icon:"delete",dense:"",flat:"",onClick:e.removeSite},null,8,["onClick"])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",De,[(0,o.bF)(m,{class:"col-grow",label:"Theme",dense:"",modelValue:e.data.theme,"onUpdate:modelValue":a[3]||(a[3]=a=>e.data.theme=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-grow",label:"Domain",dense:"",modelValue:e.data.domain,"onUpdate:modelValue":a[4]||(a[4]=a=>e.data.domain=a)},null,8,["modelValue"])]),(0,o.Lk)("div",Ee,[ze,(0,o.bF)(i,{class:"col-12",modelValue:e.data.track,"onUpdate:modelValue":a[5]||(a[5]=a=>e.data.track=a),showName:!1,showMenaceBtn:!1},null,8,["modelValue"])]),Me,(0,o.Lk)("div",Ae,[(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"01-27 Very Common",square:"",modelValue:e.data.denizens.veryCommon,"onUpdate:modelValue":a[6]||(a[6]=a=>e.data.denizens.veryCommon=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"28-41 Common",square:"",modelValue:e.data.denizens.common1,"onUpdate:modelValue":a[7]||(a[7]=a=>e.data.denizens.common1=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"42-55 Common",square:"",modelValue:e.data.denizens.common2,"onUpdate:modelValue":a[8]||(a[8]=a=>e.data.denizens.common2=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"56-69 Common",square:"",modelValue:e.data.denizens.common3,"onUpdate:modelValue":a[9]||(a[9]=a=>e.data.denizens.common3=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"70-75 Uncommon",square:"",modelValue:e.data.denizens.uncommon1,"onUpdate:modelValue":a[10]||(a[10]=a=>e.data.denizens.uncommon1=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"76-81 Uncommon",square:"",modelValue:e.data.denizens.uncommon2,"onUpdate:modelValue":a[11]||(a[11]=a=>e.data.denizens.uncommon2=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"82-87 Uncommon",square:"",modelValue:e.data.denizens.uncommon3,"onUpdate:modelValue":a[12]||(a[12]=a=>e.data.denizens.uncommon3=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"88-93 Uncommon",square:"",modelValue:e.data.denizens.uncommon4,"onUpdate:modelValue":a[13]||(a[13]=a=>e.data.denizens.uncommon4=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"94-95 Rare",square:"",modelValue:e.data.denizens.rare1,"onUpdate:modelValue":a[14]||(a[14]=a=>e.data.denizens.rare1=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"96-97 Rare",square:"",modelValue:e.data.denizens.rare2,"onUpdate:modelValue":a[15]||(a[15]=a=>e.data.denizens.rare2=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"98-99 Rare",square:"",modelValue:e.data.denizens.rare3,"onUpdate:modelValue":a[16]||(a[16]=a=>e.data.denizens.rare3=a)},null,8,["modelValue"]),(0,o.bF)(m,{class:"col-xs-6 col-sm-3",label:"100 Unforeseen",square:"",modelValue:e.data.denizens.unforeseen,"onUpdate:modelValue":a[17]||(a[17]=a=>e.data.denizens.unforeseen=a)},null,8,["modelValue"])]),(0,o.Lk)("div",Se,[We,(0,o.Lk)("div",Qe,[(0,o.bF)(u,{name:"arrow_right",size:"sm"})]),Xe,Re,je,Oe,Ke,_e,Ne]),(0,o.bF)(m,{class:"row q-pt-md q-mb-sm",label:"Notes",dense:"",modelValue:e.data.notes,"onUpdate:modelValue":a[18]||(a[18]=a=>e.data.notes=a),autogrow:""},null,8,["modelValue"])])),_:1},8,["icon","label"])}const Te=(0,o.pM)({name:"WSite",components:{ProgressTrack:ee.A,IInput:ce.A,Controls:me},props:{modelValue:{type:Object,required:!0},controls:{type:Boolean}},emits:["update:modelValue","delete","move"],setup(e,{emit:a}){const l=(0,F.KR)(e.modelValue);(0,o.wB)((()=>e.modelValue),(()=>l.value=e.modelValue),{deep:!0});const t=()=>a("update:modelValue",l.value),n=()=>a("delete"),s=(0,L.U)();return{data:l,updateValue:t,removeSite:n,icon:O.K,config:s}}});var Be=l(4609);const He=(0,se.A)(Te,[["render",$e]]),Pe=He;be()(Te,"components",{QExpansionItem:ue.A,QBtn:re.A,QIcon:Be.A});const Ge=(0,o.pM)({components:{WNpc:fe,WLocation:Le,WSite:Pe},name:"Cell",props:{mapID:{type:Number,required:!0},cellID:{type:String,required:!0}},setup(e){const a=(0,U.E)(),l=(0,F.KR)("Select"),o=()=>{switch(l.value){case q.cw.NPCs:a.data.maps[e.mapID].cells[e.cellID].npcs.unshift((0,I.Uz)());break;case q.cw.Sites:a.data.maps[e.mapID].cells[e.cellID].sites.unshift((0,I.YQ)());break;case q.cw.Locations:a.data.maps[e.mapID].cells[e.cellID].locations.unshift((0,I.G1)());break;default:break}},t=l=>a.data.maps[e.mapID].cells[e.cellID][l]&&a.data.maps[e.mapID].cells[e.cellID][l].length>0,n=(0,L.U)(),s=(0,F.KR)(!1);return{config:n,campaign:a,EMapItems:q.cw,addSelect:l,add:o,show:t,showControls:s}}});var Ze=l(449);const Ye=(0,se.A)(Ge,[["render",T]]),Je=Ye;be()(Ge,"components",{QToggle:Ze.A,QSelect:qe.A,QBtn:re.A});var ea=function(e,a,l,o){function t(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,n){function s(e){try{m(o.next(e))}catch(a){n(a)}}function d(e){try{m(o["throw"](e))}catch(a){n(a)}}function m(e){e.done?l(e.value):t(e.value).then(s,d)}m((o=o.apply(e,a||[])).next())}))};const aa=(0,o.pM)({name:"HexMap",components:{Cell:Je},props:{searchResults:{type:Object,default:{}}},setup(e){const a=(0,F.KR)(null),l=(0,U.E)(),t=(0,L.U)(),n=(0,Q.A)(),s=(0,F.KR)(!1),d=(0,F.KR)(""),m=(0,F.KR)(!0),c=(e,a)=>{console.log(a,e),l.data.maps[t.data.map].scrollX=a,l.data.maps[t.data.map].scrollY=e},i=(e,a)=>`h-${e}-${a}`,u=()=>{if(l.data.maps[t.data.map].hexW)return l.data.maps[t.data.map].hexW;const e=l.data.maps[t.data.map].width,a=l.data.maps[t.data.map].hexSize;return(0,D.H9)(e,a)},p=()=>l.data.maps[t.data.map].hexH?l.data.maps[t.data.map].hexH:(0,D.AT)(l.data.maps[t.data.map].height,l.data.maps[t.data.map].hexSize);let r,g,b=(0,R.os)({size:l.data.maps[t.data.map].hexSize,orientation:l.data.maps[t.data.map].hexFlat?"flat":"pointy"}),h=(0,R.kg)(b);(0,o.sV)((()=>ea(this,void 0,void 0,(function*(){console.log("initial map render"),g=(0,X.t4)().addTo(a.value).size("100%","100%"),yield f()}))));const f=()=>ea(this,void 0,void 0,(function*(){m.value=!0,yield v(),k(),y(),w(),x(),C(),g.transform({origin:[0,0],scale:l.data.maps[t.data.map].zoom}),m.value=!1})),V=e=>{const a=e.split(/-/g);if(3===a.length){const e=r.get({x:+a[1],y:+a[2]});if(e){const{x:a,y:l}=e.toPoint();return{x:a,y:l}}}return{x:0,y:0}},v=()=>ea(this,void 0,void 0,(function*(){yield(0,D.yy)(0),console.log("Rendering map"),g.clear(),b=(0,R.os)({size:l.data.maps[t.data.map].hexSize,orientation:l.data.maps[t.data.map].hexFlat?"flat":"pointy"}),h=(0,R.kg)(b),r=h.rectangle({width:u(),height:p()});const e=b().corners(),a=e.map((e=>`${e.x},${e.y}`)).join(" "),o=g.polygon(a).addClass("hex").fill("none");r.forEach((e=>{const{x:a,y:l}=e.toPoint(),t=i(e.x,e.y);o.clone().addClass(t).addTo(g).translate(a,l)}));const n=(0,X.t4)().image(l.data.maps[t.data.map].image);n.addTo(g).back()})),k=()=>{console.log("Rendering fills");const e=l.data.maps[t.data.map].cells;Object.keys(e).forEach((a=>{g.find(`.${a}`).forEach((l=>{const o=e[a];switch(o.stat){case q.Ug.Location:l.fill(j.location);break;case q.Ug.Route:l.fill(j.route);break;default:l.fill("none");break}}))}))},w=()=>{console.log("Rendering labels"),g.find(".labels").forEach((e=>e.remove()));const e=(0,X.t4)().group().addClass("labels"),a=l.data.maps[t.data.map].hexSize,o=l.data.maps[t.data.map].cells;Object.keys(o).forEach((n=>{const s=o[n];if(s.stat===q.Ug.Location){let{label:o,type:d}=(0,I.fZ)(s,n);const{x:m,y:c}=V(n);(0,X.t4)().text(o).addClass("label").addTo(e).font({fill:j[d]||"white",weight:"bold",size:l.data.maps[t.data.map].fonts.label.size}).stroke({color:"black",width:1}).move(m-.5*a,c-a)}})),e.addTo(g).front()},x=()=>{console.log("Rendering search results"),g.find(".search-label").forEach((e=>e.remove())),e.searchResults!={}&&e.searchResults[t.data.map]&&Object.keys(e.searchResults[t.data.map]).forEach((a=>{if(e.searchResults[t.data.map][a]){const{x:o,y:n}=V(a),s=e.searchResults[t.data.map][a];let{label:d}=(0,I.fZ)(l.data.maps[t.data.map].cells[a],a);g.find(`.${a}`).length>0&&(0,X.t4)().text((function(e){Object.keys(s).forEach((o=>{s[o].forEach((n=>{const s=l.data.maps[t.data.map].cells[a][o][n];s&&s.name!==d&&e.tspan(s.name).stroke({color:"black",width:1}).fill(j[o]).newLine()}))}))})).addClass("search-label").addTo(g).move(o,n+2.5*l.data.maps[t.data.map].hexSize).font({size:l.data.maps[t.data.map].fonts.search.size,weight:"bold"})}}))},y=()=>{console.log("Rendering icons"),g.find(".icons").forEach((e=>e.remove()));const e=(0,X.t4)().group().addClass("icons"),a=l.data.maps[t.data.map].cells;Object.keys(a).forEach((o=>{const n=a[o];if(n.stat===q.Ug.Location){const{x:a,y:s}=V(o),d=l.data.maps[t.data.map].hexSize;let m="";n.npcs.length>0&&(m=O.K.person()),n.sites.length>0&&(m=O.K.dungeon()),n.locations.length>0&&(m=O.K.location(n.locations[0].type));const c=(0,X.t4)().image(m).addClass("icon").size(d,d).addTo(e).move(a+d/2.6,s+d/2);c.mouseenter((()=>c.animate(100).transform({scale:1.3}))),c.mouseleave((()=>c.animate(100).transform({scale:1})))}})),e.addTo(g)},C=()=>{if(console.log("Render player icon"),!l.data.maps[t.data.map].player)return;const e=l.data.maps[t.data.map].player;g.find(".player").forEach((e=>e.remove()));const a=l.data.maps[t.data.map].hexSize,{x:o,y:n}=V(e);(0,X.t4)().image(O.K.player()).addClass("player").size(a,a).addTo(g).move(o+a,n).front()},E=e=>{const a=r.get(h.pointToHex(e.offsetX,e.offsetY)),o=i(a.x,a.y);if(!l.data.maps[t.data.map].cells[o]||l.data.maps[t.data.map].cells[o].stat==q.Ug.Empty){g.find(`.${o}`).forEach((e=>e.fill(j.route)));const e=(0,I.ho)(o);return e.stat=q.Ug.Route,void(l.data.maps[t.data.map].cells[o]=e)}d.value=o,s.value=!0};return(0,o.wB)((()=>l.data.maps[t.data.map].zoom),(()=>{n.platform.is.safari?W.Ay.css(a.value,{transformOrigin:"0 0",scale:`${l.data.maps[t.data.map].zoom}`}):g.transform({origin:[0,0],scale:l.data.maps[t.data.map].zoom})})),(0,o.wB)((()=>[l.data.maps[t.data.map].height,l.data.maps[t.data.map].width,l.data.maps[t.data.map].hexSize,l.data.maps[t.data.map].hexFlat,l.data.maps[t.data.map].hexW,l.data.maps[t.data.map].hexH]),(()=>{console.log("Map config triggered render"),f()}),{deep:!0}),(0,o.wB)((()=>l.data.maps[t.data.map].fonts),(()=>{w(),x()}),{deep:!0}),(0,o.wB)((()=>l.data.maps[t.data.map].cells),(()=>{console.log("Cell data triggered render"),k(),y(),w()}),{deep:!0}),(0,o.wB)((()=>e.searchResults),(()=>{console.log("Search data triggered render"),x()}),{deep:!0}),(0,o.wB)((()=>l.data.maps[t.data.map].player),(()=>C())),{campaign:l,config:t,mapLoading:m,hexmap:a,click:E,onScroll:c,showDialog:s,selectedID:d,ECellStatus:q.Ug}}});var la=l(500),oa=l(1102),ta=l(3177),na=l(7201),sa=l(7569),da=l(7066),ma=l(8926),ca=l(658);const ia=(0,se.A)(aa,[["render",S]]),ua=ia;be()(aa,"components",{QLayout:la.A,QPageContainer:oa.A,QPage:ta.A,QBtn:re.A,QDialog:na.A,QCard:sa.A,QCardSection:da.A,QInput:ma.A,QSelect:qe.A}),be()(aa,"directives",{Scroll:ca.A});const pa=(0,o.pM)({name:"World",components:{HexMap:ua,IInput:ce.A,WSite:Pe,WNpc:fe,WLocation:Le},setup(){const e=(0,U.E)(),a=(0,L.U)();e.data.maps[a.data.map]||(a.data.map=0);const l=(0,F.KR)(""),t=(0,F.KR)([]),n=(0,F.KR)(!1),s=(0,o.EW)((()=>{const a=[];return e.data.maps.forEach(((e,l)=>{a.push({label:e.name,value:l})})),a})),d=(0,o.EW)((()=>null!=t.value&&t.value.length>0)),m=e=>null===l.value||RegExp(l.value,"i").test(e),c=(0,o.EW)((()=>{const a={},l=(e,l,o)=>{a[e]||(a[e]={}),a[e][l]||(a[e][l]={}),a[e][l][o]||(a[e][l][o]=[])};return e.data.maps.forEach(((e,o)=>{Object.keys(e.cells).forEach((t=>{Object.values(q.cw).forEach((n=>{for(let s=0;s<e.cells[t][n].length;s++)switch(n){case q.cw.Locations:i.locations(e.cells[t][n][s])&&(l(o,t,n),a[o][t][n].push(s));break;case q.cw.NPCs:i.npcs(e.cells[t][n][s])&&(l(o,t,n),a[o][t][n].push(s));break;case q.cw.Sites:i.sites(e.cells[t][n][s])&&(l(o,t,n),a[o][t][n].push(s));break;default:break}}))}))})),a})),i={locations:e=>!(d.value&&!t.value.includes(q.cw.Locations))&&(m(e.name)||m(e.descriptor)),npcs:e=>!(d.value&&!t.value.includes(q.cw.NPCs))&&(m(e.name)||m(e.kin)||m(e.notes)),sites:e=>!(d.value&&!t.value.includes(q.cw.Sites))&&m(e.name)},u=()=>({show:!1,image:null,loaded:!1,name:"",height:0,width:0}),p=(0,F.KR)(u());let r=(0,I.zf)("");const g=()=>{const e=p.value.image,a=new FileReader;a.onload=e=>{var a;const l=null===(a=e.target)||void 0===a?void 0:a.result,o=new Image;o.src=l,o.decode().then((()=>{r=(0,I.zf)(l,p.value.name),p.value.height=o.naturalHeight,p.value.width=o.naturalWidth,p.value.loaded=!0}))},a.readAsDataURL(e)},b=()=>{r.height=p.value.height,r.width=p.value.width,r.hexSize=20,e.data.maps.push(r),p.value.show=!1},h=()=>{const l=a.data.map;a.data.map=0,e.data.maps.splice(l,1)},f=(0,F.KR)({height:0,width:0,hex:0,hexW:0,hexH:0,flat:!1,locLabel:0,srcLabel:0}),V=()=>{f.value.height=e.data.maps[a.data.map].height,f.value.width=e.data.maps[a.data.map].width,f.value.hex=e.data.maps[a.data.map].hexSize,f.value.hexW=e.data.maps[a.data.map].hexW?e.data.maps[a.data.map].hexW:(0,D.H9)(e.data.maps[a.data.map].width,e.data.maps[a.data.map].hexSize),f.value.hexH=e.data.maps[a.data.map].hexH?e.data.maps[a.data.map].hexH:(0,D.AT)(e.data.maps[a.data.map].height,e.data.maps[a.data.map].hexSize),f.value.flat=e.data.maps[a.data.map].hexFlat||!1,f.value.locLabel=e.data.maps[a.data.map].fonts.label.size,f.value.srcLabel=e.data.maps[a.data.map].fonts.search.size,n.value=!0},v=()=>{Object.assign(e.data.maps[a.data.map],{height:f.value.height,width:f.value.width,hexSize:f.value.hex,hexW:f.value.hexW,hexH:f.value.hexH,hexFlat:f.value.flat}),e.data.maps[a.data.map].fonts.label.size=f.value.locLabel,e.data.maps[a.data.map].fonts.search.size=f.value.srcLabel};return{campaign:e,config:a,mapOpts:s,NewMapLoad:u,showMapConfig:n,openMapConfig:V,saveMapConfig:v,mapConfig:f,mapLoad:p,loadMap:g,saveMap:b,removeMap:h,EMapItems:q.cw,filters:t,searchText:l,results:c,show:i,CellLabel:I.fZ}}});var ra=l(6334),ga=l(9869);const ba=(0,se.A)(pa,[["render",C]]),ha=ba;be()(pa,"components",{QPage:ta.A,QBtn:re.A,QSelect:qe.A,QExpansionItem:ue.A,QCardSection:da.A,QDialog:na.A,QCard:sa.A,QInput:ma.A,QToggle:Ze.A,QCardActions:ra.A,QFile:ga.A})}}]);